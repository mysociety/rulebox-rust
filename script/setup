#!/bin/bash
# script/setup
# Set up the project for development

set -e

cd "$(dirname "$0")/.."

echo "==> Setting up RuleBox Python bindings for development..."

# Check if uv is installed, install if needed
if ! command -v uv &> /dev/null; then
    echo "==> Installing uv..."
    curl -LsSf https://astral.sh/uv/install.sh | sh
    source $HOME/.cargo/env
fi

# Navigate to the Python bindings directory
cd rulebox-python

# Create virtual environment and install dependencies
echo "==> Setting up virtual environment and installing dependencies..."
uv sync --extra dev

# Activate virtual environment
source .venv/bin/activate

# Build the extension
echo "==> Building Python extension..."
maturin develop

echo "==> Setup complete!"
echo ""
echo "To activate the virtual environment:"
echo "  cd rulebox-python && source .venv/bin/activate"
echo ""
echo "To run tests:"
echo "  script/test"
echo ""
echo "To see all available commands:"
echo "  script/help"